setcps(140/60/8)

await initHydra({ feedStrudel: 1 })

//
shape([4,5,6].fast(0.1).smooth(1),0.000001,[0.2,0.7].smooth(1))
.color(0.2,0.4,0.3)
.scrollX(()=>Math.sin(time*0.27))
.add(
  shape([4,5,6].fast(0.1).smooth(1),0.000001,[0.2,0.7,0.5,0.3].smooth(1))
  .color(0.6,0.2,0.5)
  .scrollY(0.35)
  .scrollX(()=>Math.sin(time*0.33)))
.add(
  shape([4,5,6].fast(0.1).smooth(1),0.000001,[0.2,0.7,0.3].smooth(1))
  .color(0.2,0.4,0.6)
  .scrollY(-0.35)
  .scrollX(()=>Math.sin(time*0.41)*-1))
.add(
      src(o0).shift(0.001,0.01,0.001)
      .scrollX([0.05,-0.05].fast(0.1).smooth(1))
      .scale([1.05,0.9].fast(0.3).smooth(1),[1.05,0.9,1].fast(0.29).smooth(1))
      ,0.85)
.modulate(voronoi(10,2,2))
.out()
//

_f1: s("flute-recordings")
  .loopAt(4)
  .begin("<0.01>")
  .end("<.05>")
  .fast(32)
  .gain(2)

f2: s("flute-recordings")
  .n(2)
  .end(0.9)
  .lpf(sine.range(2500, 3000))
  .room(0.5)
  .loop(1)
  .gain(slider(2.2, 0.1, 3, 0.1))

_texture: note("[g#4 g#4 g#4 g#4] [f#4 f#4 f#4 f#4]")
  .s("gm_pad_choir")
  .add(note(perlin.range(-0.1, 0.1)))
  .lpf(sine.range(400, 2000).slow(8))
  .attack(0.5)
  .release(2)
  .pan(sine.range(0.2, 0.8).slow(4))

_saw_chords: n("0!8".sub(14))
  .scale("g#3:minor")
  .s("supersaw!16").lpenv(irand(5))
  .orbit(2)
  .decay(0.6)
  .gain(0.4)

_saw_notes: n("0 -7 <3 2 1>@3")
  .scale("g#3:minor")
  .s("supersaw")
  .delay(.7).pan(rand)
  .lpf(slider(405, 100, 2000, 1))

sub: note("g#2")
  .s("sine")
  .struct("<x ~ ~ ~ ~ ~ ~ ~>")
  .lpf(150)

_pulse: s("pulse!8")
  .seg(16)
  .dec(.1)
.gain(0.2)
// .fm(time)
// .fmh(time)
.fm("0@2 1 <3>@3")
.fmh("0@2 1 <3>@3")

_glitch: s("bd bd ~ bd, ~ cp ~ cp*2, hh*16")
  .bank("RolandTR909")
  .sometimes(ply(2))
  .sometimes(x => x.speed("-1"))
  .gain("0.9 0.8 0.7 0.6")

kick: sound("bd*8")
  .bank("RolandTR909")
  .gain(4)

_perc: s("rim ~ rim rim*4")
  .bank("RolandTR808")
  .n("<0 1 2 3>")
  .sometimes(x => x.chop(8))
  .pan("0 1 0.5")
  .gain(0.8)

_white: s("white!8")
  .decay(0.03)
  .lpf(3000)
  .almostNever(
    ply("4 | 2")
  )
  .gain(.4)

_clicks: s("~ ~ ~ <bd cp rim>*<2 4 8>")
  .bank("CasioRZ1")
  .chop("<4 8 16>")
  .speed("<1 -1 0.5 2>")
  .gain(0.7)
  .pan(sine.range(0,1).slow(2))

_bass: note("<c1 eb1>")
  .s("sawtooth")
  .lpf(1000)
  .decay(0.1)
  .sometimes(x => x.add(note(16)))
  .gain(0.8)

